<!DOCTYPE html>
<!-- saved from url=(0029)http://endoflow.com/exposure/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Exposure Calculator</title>
<meta name="Description" content="An online exposure calculator.  Enter aperture, speed and ISO
    settings, lock the exposure, then tweak values to see how the others change to keep a
    consistent exposure.">
<style>
  
  body {
    height: 100%;
  }
  
  h1 {
    color: #444;
    font: normal 32px helvetica, arial, sans-serif;
    margin: 20px 0 0 20px;
  }
    
  h2 {
    color: #999;
    font: normal 22px helvetica, arial, sans-serif;
    margin: 40px 0 0 20px;
    border-bottom: 1px solid #ddd;
    width: 746px;
  }

  ol, ul {
    font: normal 14px/20px helvetica, arial, sans-serif;
    color: #444;
    margin-top: 6px;
  }
  
  ul ul {
    margin-top: 0;
  }
  
  p {
    font: normal 14px/20px helvetica, arial, sans-serif;
    color: #999;    
  }
  
  .setting {
    float: left;
    display: block;
    margin: 20px;
    padding: 0 10px 8px 10px;
    width: 200px;
    border: 1px solid #ddd;
    font: normal 16px/24px helvetica, arial, sans-serif;
    background-color: #fff;
  }
  
  .setting b {
    color: #333;
    font-size: 12px;
  }
  
  .setting input, #ev {
    border: 0;
    font: normal 18px helvetica, arial, sans-serif;
    color: #000;
    width: 75px;
    background-color: lightyellow;
  }
  
  .options {
    margin-left: 20px;
  }
  
  #ev {
    display: inline-block;
  }
  
  #tm {
    font-size: 12px;
    margin-left: 6px;
  }
  
  #time input {
    text-align: right;
  }
  
  #output {
    background-color: #fafafa;
    padding-bottom: 3px;
    margin-bottom: 20px;
    float: none;
    clear: both;
    width: 724px;
  }
  
  #lock {
    position: relative;
    display: inline-block;
    user-select: none; 
    -moz-user-select: none; 
    -khtml-user-select: none; 
    -webkit-user-select: none; 
    -o-user-select: none; 
    padding: 7px 12px;
    margin-right: 10px;
    top: -9px;
    width: 80px;
    text-align: center;
    color: #6e6e6e;
    font: bold 12px helvetica, arial, sans-serif;
    text-shadow: 0 1px 0 #fff;
    text-decoration: none;
    -webkit-transition: all 0.15s;
    -moz-transition: all 0.15s;
    transition: all 0.15s;
    background-color: #f2f2f2;
    background: -webkit-gradient(linear, 0% 40%, 0% 70%, from(#f5f5f5), to(#eeeeee));
    background: -moz-linear-gradient(linear, 0% 40%,0% 70%, from(#f5f5f5), to(#eeeeee));
    border: solid 1px #dcdcdc;
    border-radius: 2px;
    cursor: pointer;
  }
  
  #lock:hover {
    color: #333;
    border-color: #999;
    box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.1);
    -moz-box-shadow: 0 2px 2px rgba(0, 0, 0, 0.1);
    -webkit-box-shadow:0 2px 2px rgba(0, 0, 0, 0.1);
  }
  
  #lock:active {
    color: #000;
    border-color: #444;
  }
  
  #copyright {
    margin: 40px 0 0 20px;
    padding: 10px 0;
    border-top: 1px solid #ddd;
    width: 726px;
    font: normal 12px helvetica, arial, sans-serif;
    color: #aaa;
  }
  
</style>

</head>
<body>

<h1>Exposure Calculator</h1>

<p id="aperture" class="setting">
  <b><u>A</u>perture</b><br>
  f / <input id="n" value="16" type="text">
</p>

<p id="time" class="setting">
  <b>Exposure <u>T</u>ime</b><br>
  <input id="t" value="1/125" type="text"> s <span id="tm"></span>
</p>

<p id="iso" class="setting">
  <b><u>S</u>ensitivity</b><br>
  ISO <input id="s" value="100" type="text">
</p>

<p id="output" class="setting">
  <b>Exposure Value</b><br>
  EV<sub>100</sub> = <span id="ev">8</span><br>
  <span id="desc">Las Vegas or Times Square at night. Store windows. Campfires, bonfires, burning buildings. Ice shows, football, baseball etc. at night. Interiors with bright florescent lights.</span>
  <br><br>
  <span id="lock">Un<u>l</u>ock</span>
</p>

<p class="options">  
  <input type="checkbox" id="round" checked="">
  <label for="round" title="Only rounds within reasonable extremes.">Round to nearest third-stop.</label>
</p>


<h2>How to use:</h2>
<ol>
  <li>Enter the camera settings for a known exposure.</li>
  <li>Lock the exposure.</li>
  <li>Tweak indivdual settings, watch the others adjust to keep exposure consistent.</li>
  <li>Use keyboard shortcuts to get around quicker: A, T, S, L, &#8593;, &#8595;.
</li></ol>

<h2>Information:</h2>
<ul>
  <li><code>EV = log<sub>2</sub>(N<sup>2</sup> / t)</code> where N = f-number and t = exposure time in seconds.</li>
  <li><code>EV<sub>S</sub> = EV<sub>100</sub> + log<sub>2</sub>(S / 100)</code> where S = desired ISO.</li>
  <li>I wrote this tool to plan long exposures outside my camera's typical range.</li>
  <li>
    Get more background on exposure and camera settings from
    <a href="http://www.fredparker.com/ultexp1.htm">Fred Parker</a>.
  </li>
  <li>Useful wikipedia articles:
    <ul>
      <li><a href="http://en.wikipedia.org/wiki/Exposure_value">Exposure Value</a></li>
      <li><a href="http://en.wikipedia.org/wiki/Shutter_speed">Shutter Speed</a></li>
      <li><a href="http://en.wikipedia.org/wiki/F-number">F-Number (Aperture)</a></li>
      <li><a href="http://en.wikipedia.org/wiki/Sunny_16_rule">Sunny f/16 rule</a></li>
    </ul>
  </li>
</ul>

<p id="copyright">Copyright ï¿½2011 Daniel Pupius. All rights reserved.</p>


<script>

// Descriptions from Fred Parker's site (http://www.fredparker.com/ultexp1.htm)
var levels = {
  "-6": "Night, subject under starlight only.",
  "-5": "Night, subject under crescent moon.",
  "-4": "Night, subject under half moon.",
  "-3": "Night, subject under full moon.",
  "-2": "Night, snowscape under full moon.",
  "-1": "Subjects lit by dim ambient artificial light.",
  "0": "Subjects lit by dim ambient artificial light.",
  "1": "Distant view of lighted skyline.",
  "2": "Lightning (with time exposure). Total eclipse of moon.",
  "3": "Fireworks (with time exposure).",
  "4": "Candle lit close-ups. Christmas lights, floodlit buildings, fountains, and monuments. Subjects under bright street lamps.",
  "5": "Night home interiors, average light. School or church auditoriums. Subjects lit by campfires or bonfires.",
  "6": "Brightly lit home interiors at night. Fairs, amusement parks.",
  "7": "Bottom of rainforest canopy. Brightly lighted nighttime streets. Indoor sports. Stage shows, circuses.",
  "8": "Las Vegas or Times Square at night. Store windows. Campfires, bonfires, burning buildings. Ice shows, football, baseball etc. at night. Interiors with bright florescent lights.",
  "9": "Landscapes, city skylines 10 minutes after sunset. Neon lights, spotlighted subjects.",
  "10": "Landscapes and skylines immediately after sunset.",
  "11": "Sunsets. Subjects in deep shade.",
  "12": "Subject in open shade or heavy overcast.",
  "13": "Subjects in cloudy-bright light (no shadows).",
  "14": "Subjects in weak, hazy sun.",
  "15": "Subjects in bright or hazy sun. (Sunny f/16 rule)",
  "16": "Subjects in bright daylight on sand or snow.",
  "17": "Very bright.  Some man made lighting.",
  "22": "Extremely bright. Rarely encountered in nature.",
};


// Manual list of apetures, speeds and ISOs at 1/3 stop increments.
var fstops = [0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.4, 1.6, 1.8, 2, 2.2, 2.5, 2.8, 3.2, 3.5, 4, 4.5, 5.0, 5.6, 6.3, 7.1, 8, 9, 10, 11, 13, 14, 16, 18, 20, 22, 27, 32, 38, 45, 54, 64, 76, 91, 108];
var shutterSpeeds = [1/8000, 1/6400, 1/5000, 1/4000, 1/3200, 1/2500, 1/2000, 1/1600, 1/1250, 1/1000, 1/800, 1/640, 1/500, 1/400, 1/320, 1/250, 1/200, 1/160, 1/125, 1/100, 1/80, 1/60, 1/50, 1/40, 1/30, 1/25, 1/20, 1/15, 1/13, 1/10, 1/8, 1/6, 1/5, 1/4, 0.3, 0.4, 0.5, 0.6, 0.8, 1, 1.3, 1.6, 2, 2.5, 3.2, 4, 5];
var isos = [50, 100, 125, 160, 200, 250, 320, 400, 500, 640, 800, 1000, 1250, 1600, 2000, 2500, 3200, 4000, 5000, 6400, 12800, 25600];


var locked = false;
var exposureValue = 0;
var lockEl = byId('lock');

lockEl.addEventListener('click', toggleLocked, false);
document.body.addEventListener('change', change, false);
document.body.addEventListener('click', selectInput, false);
document.body.addEventListener('keydown', handleKey, false);

change();


function change(e) {
  var values = getValues();
  if (!locked) {
    calculateEv(values);
  } else {
    switch (e && e.target.id) {
      case 'n': updateSpeedToFit(values); break;
      case 't': updateApertureToFit(values); break;
      case 's': updateSpeedToFit(values); break;
    }
  }
}

function selectInput(e) {
  if (e.target.tagName == 'INPUT') e.target.select();
}

function toggleLocked(e) {
  lockEl.innerHTML = locked ? '<u>L</u>ock' : 'Un<u>l</u>ock';
  locked = !locked;
}

function handleKey(e) {
  switch (e.keyCode) {
    case 65: focus('n'); break;        // A
    case 84: focus('t'); break;        // T
    case 83: focus('s'); break;        // S
    case 76: toggleLocked(); break;    // L
    case 38:                           // Up
      arrow(e.target.id, 1);
      break;
    case 40:                           // Down 
      arrow(e.target.id, -1);
      break; 
    case 13:                           // Enter
      change(e);
      e.target.select();
      break;
    default: return;
  }
  e.preventDefault();
}

function arrow(id, dir) {
  var array;
  switch (id) {
    case 'n': array = fstops; break;
    case 't': array = shutterSpeeds; break;
    case 's': array = isos; break;
    default: return;
  }
  
  var values = getValues();
  var val = roundToArray(values[id], array);
  if (values[id] == val ||
      dir == 1 && values[id] > val ||
      dir == -1 && values[id] < val) {
    val = array[array.indexOf(val) + dir];
  }
  
  if (!val) return;
  
  values[id] = val;
  
  if (!locked) {
    calculateEv(values);
  } else {
    switch (id) {
      case 'n': updateSpeedToFit(values); break;
      case 't': updateApertureToFit(values); break;
      case 's': updateSpeedToFit(values); break;
    }
  }
}

function focus(id) {
  byId(id).focus();
  byId(id).select();
}

// Find an aperture to match the other values. 
function updateApertureToFit(v) {
  v.n = Math.sqrt(v.t * Math.pow(2, exposureValue + log2(v.s / 100)));
  updateDisplay(v);
}

// Change time to account for changes in the other values.
function updateSpeedToFit(v) {
  v.t = (v.n * v.n) / Math.pow(2, exposureValue + log2(v.s / 100)); 
  updateDisplay(v);
}

// Calculate the EV100 for the aperture, speed and ISO.
function calculateEv(v) {
  var ev = log2(v.n * v.n / v.t);
  exposureValue = ev - log2(v.s / 100);
  updateDisplay(v);
}

function updateDisplay(v) {
  if (byId('round').checked) {
    roundValues(v);
  }
  
  // Convert speed to a fraction, a decimal if it's less than 5, or else a whole number.
  var t = v.t < 1 ? decimalToFraction(v.t) : v.t < 5 ? Math.round(v.t * 10) / 10 : Math.round(v.t);

  byId('n').value = Math.round(v.n * 10) / 10;
  byId('t').value = t;
  byId('s').value = Math.round(v.s);

  if (v.t > 120) {
    byId('tm').innerHTML = '(' + Math.round(v.t / 6) / 10 + ' mins)';
  } else {
    byId('tm').innerHTML = '';
  }

  byId('ev').innerHTML = Math.round(exposureValue, 2);
  
  var v1 = Math.round(exposureValue);
  if (v1 > 22) v1 = 22;
  else if (v1 > 17) v1 = 17;
  else if (v1 < -6) v1 = -6;
  var description = levels[v1];
  if (!description) description = 'Bad inputs.';
  byId('desc').innerHTML = description;
}

function getValues() {
  var n = Number(byId('n').value);
  var s = Number(byId('s').value);
  var t = byId('t').value;

  if (/1\/[0-9]+/.test(t)) {
    t = eval(t);
  } else {
    t = Number(t);
  }

  var v = {n: n, s: s, t: t};

  if (byId('round').checked) {
    roundValues(v);
  }

  return v;
}

function roundValues(v) {
  v.t = roundToArray(v.t, shutterSpeeds);
  v.n = roundToArray(v.n, fstops);
  v.s = roundToArray(v.s, isos); 
}

function roundToArray(val, array) {
  // Short-circuit extremes. 
  if (val < array[0] || val > array[array.length - 1]) return val;
  var best = val;
  var bestDiff = Infinity;
  for (var i = 0; i < array.length; i++) {
    var diff = Math.abs(array[i] - val);
    if (diff <= bestDiff) {
      best = array[i];
      bestDiff = diff;
    } else {
      return best;
    }
  }
  return best;
}

function log2(x) {
  return Math.log(x) / Math.LN2;
}

function decimalPlaces(num) {
  var str = num.toString();
  var idx = str.indexOf('.');
  return idx >= 0 ? str.length - idx - 1 : 0;
}

function decimalToFraction(value) {
  var n = decimalPlaces(value);
  var m = Math.pow(10, n);
  var numerator = value * m;
  var denominator = Math.round(numerator ? m / numerator : 0);
  var numerator = numerator ? numerator / numerator : 0;
  if (denominator > 8000) {
    denominator = Math.round(denominator / 1000) * 1000;
  }
  return numerator ? numerator + '/' + denominator : '0';
}

function byId(id) {
  return document.getElementById(id);
}

</script>


<div id="forest-ext-shadow-host"><template shadowrootmode="open"><head></head><div id="root"></div></template></div></body></html>